<!-- templates/test_results.html -->
{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header">
        <h2>Artifact Generation Results</h2>
        <a href="{{ url_for('test_form') }}" class="button">&larr; Back to test form</a>
    </div>
    <div class="card-content">
        <div class="card" style="margin-top: 20px;">
            <div class="card-header">
                <h2>Input Content</h2>
            </div>
            <div class="card-content">
                <pre>{{ content[:500] }}{% if content|length > 500 %}...{% endif %}</pre>
            </div>
        </div>
        <div class="card" style="margin-top: 20px;">
            <div class="card-header">
                <h2>Project Description</h2>
            </div>
            <div class="card-content">
                <div class="text-section">
                    <div class="label">Core Summary:</div>
                    <ol>
                        {% for sentence in description.three_sentences %}
                            <li>{{ sentence }}</li>
                        {% endfor %}
                    </ol>
                </div>
                <div class="text-section">
                    <div class="label">Detailed Description:</div>
                    {% for paragraph in description.three_paragraphs %}
                        <p>{{ paragraph }}</p>
                    {% endfor %}
                </div>

                <!-- Objections Section -->
                <h3>Critical Objections</h3>
                <ul class="objections">
                  {% for objection in description.objections %}
                  <li>
                    <strong>{{ objection.title }}</strong>
                    <p>{{ objection.explanation }}</p>
                    {% if objection.impact %}
                    <div class="impact">
                      <strong>Impact:</strong> {{ objection.impact }}
                    </div>
                    {% endif %}
                    {% if objection.challenging_question %}
                    <div class="challenging-question">
                      <strong>Challenging Question:</strong> {{ objection.challenging_question }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>

                <!-- Improvements Section -->
                <h3>Strategic Improvements</h3>
                <ul class="improvements">
                  {% for improvement in description.improvements %}
                  <li>
                    <strong>{{ improvement.title }}</strong>
                    <p>{{ improvement.suggestion }}</p>
                    {% if improvement.rationale %}
                    <div class="rationale">
                      <strong>Rationale:</strong> {{ improvement.rationale }}
                    </div>
                    {% endif %}
                    {% if improvement.minimum_version %}
                    <div class="minimum-version">
                      <strong>Minimum Version:</strong> {{ improvement.minimum_version }}
                    </div>
                    {% endif %}
                    {% if improvement.benefit %}
                    <div class="benefit">
                      <strong>Benefit:</strong> {{ improvement.benefit }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>

                <!-- Debug info (comment this out in production) -->
                <!--
                <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; border: 1px solid #ccc;">
                  <h4>Debug Info:</h4>
                  <pre>{{ description|tojson }}</pre>
                </div>
                -->
            </div>
        </div>

        <!-- Internal Messaging Section -->
        {% if internal %}
        <div class="card" style="margin-top: 20px;">
            <div class="card-header">
                <h2>Internal Messaging</h2>
            </div>
            <div class="card-content">
                <!-- Internal messaging content here -->

                <!-- Objections Section -->
                <h3>Critical Objections</h3>
                <ul class="objections">
                  {% for objection in internal.objections %}
                  <li>
                    <strong>{{ objection.title }}</strong>
                    <p>{{ objection.explanation }}</p>
                    {% if objection.impact %}
                    <div class="impact">
                      <strong>Impact:</strong> {{ objection.impact }}
                    </div>
                    {% endif %}
                    {% if objection.challenging_question %}
                    <div class="challenging-question">
                      <strong>Challenging Question:</strong> {{ objection.challenging_question }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>

                <!-- Improvements Section -->
                <h3>Strategic Improvements</h3>
                <ul class="improvements">
                  {% for improvement in internal.improvements %}
                  <li>
                    <strong>{{ improvement.title }}</strong>
                    <p>{{ improvement.suggestion }}</p>
                    {% if improvement.rationale %}
                    <div class="rationale">
                      <strong>Rationale:</strong> {{ improvement.rationale }}
                    </div>
                    {% endif %}
                    {% if improvement.minimum_version %}
                    <div class="minimum-version">
                      <strong>Minimum Version:</strong> {{ improvement.minimum_version }}
                    </div>
                    {% endif %}
                    {% if improvement.benefit %}
                    <div class="benefit">
                      <strong>Benefit:</strong> {{ improvement.benefit }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}

        <!-- External Messaging Section -->
        {% if external %}
        <div class="card" style="margin-top: 20px;">
            <div class="card-header">
                <h2>External Messaging</h2>
            </div>
            <div class="card-content">
                <!-- External messaging content here -->

                <!-- Objections Section -->
                <h3>Critical Objections</h3>
                <ul class="objections">
                  {% for objection in external.objections %}
                  <li>
                    <strong>{{ objection.title }}</strong>
                    <p>{{ objection.explanation }}</p>
                    {% if objection.impact %}
                    <div class="impact">
                      <strong>Impact:</strong> {{ objection.impact }}
                    </div>
                    {% endif %}
                    {% if objection.challenging_question %}
                    <div class="challenging-question">
                      <strong>Challenging Question:</strong> {{ objection.challenging_question }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>

                <!-- Improvements Section -->
                <h3>Strategic Improvements</h3>
                <ul class="improvements">
                  {% for improvement in external.improvements %}
                  <li>
                    <strong>{{ improvement.title }}</strong>
                    <p>{{ improvement.suggestion }}</p>
                    {% if improvement.rationale %}
                    <div class="rationale">
                      <strong>Rationale:</strong> {{ improvement.rationale }}
                    </div>
                    {% endif %}
                    {% if improvement.minimum_version %}
                    <div class="minimum-version">
                      <strong>Minimum Version:</strong> {{ improvement.minimum_version }}
                    </div>
                    {% endif %}
                    {% if improvement.benefit %}
                    <div class="benefit">
                      <strong>Benefit:</strong> {{ improvement.benefit }}
                    </div>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}